{
  "$schema": "https://shadcn-vue.com/schema/registry-item.json",
  "name": "tel-input",
  "type": "registry:component",
  "title": "Tel Input",
  "author": "Danilo León <dlg9806@gmail.com>",
  "description": "Componente para seleccionar números telefónicos.",
  "registryDependencies": [
    "input",
    "button"
  ],
  "files": [
    {
      "path": "app/registry/tel-input/TelInput.vue",
      "content": "<script setup lang=\"ts\">\nimport type { CountryCode } from 'libphonenumber-js'\nimport { onClickOutside } from '@vueuse/core'\nimport { AsYouType, getCountries, getCountryCallingCode } from 'libphonenumber-js'\nimport Button from '@/components/ui/button/Button.vue'\nimport Input from '@/components/ui/input/Input.vue'\n\ninterface Country {\n  id: CountryCode\n  name: string | undefined\n  code: string\n  flag: CountryCode\n}\n\nconst { placeholder = 'Número de teléfono' } = defineProps<{\n  placeholder?: string\n}>()\n\nconst model = defineModel<string>()\n\nconst target = useTemplateRef('target')\nconst phone = ref('')\nconst open = ref(false)\nconst search = ref('')\nconst currentLocale = ref('es')\nconst specialCountryCodes = [\n  'SX',\n  'BQ',\n  'BV',\n  'GF',\n  'GP',\n  'HM',\n  'IO',\n  'PM',\n  'RE',\n  'SJ',\n  'UM',\n  'XK',\n  'AH',\n  'NY',\n  'AK',\n  'AC',\n]\n\nconst regionNames = computed(() => new Intl.DisplayNames([currentLocale.value], { type: 'region' }))\nconst countries = computed<Country[]>(() =>\n  getCountries()\n    .map(code => ({\n      id: code,\n      name: regionNames.value.of(code),\n      code: `+${getCountryCallingCode(code)}`,\n      flag: code,\n    }))\n    .sort((a, b) => (a.name as string).localeCompare(b.name as string)),\n)\nconst selectedCountry = ref(countries.value.find(c => c.id === 'CU')!)\n\nconst filteredCountries = computed(() =>\n  countries.value.filter(c =>\n    c.name?.toLowerCase().includes(search.value.toLowerCase())\n    || c.id.toLowerCase().includes(search.value.toLowerCase())\n    || c.code.includes(search.value),\n  ),\n)\n\nonClickOutside(target, (_event) => {\n  if (open.value) {\n    open.value = false\n  }\n})\n\nfunction onInput(e: string | number) {\n  const input = e.toString()\n  const formatter = new AsYouType(selectedCountry.value.id)\n  phone.value = formatter.input(input)\n  model.value = formatter.getNumber()?.formatInternational() ?? undefined\n}\n\nfunction selectCountry(c: Country) {\n  selectedCountry.value = c\n  currentLocale.value = c.id\n  open.value = false\n  search.value = ''\n  if (phone.value) {\n    onInput(phone.value)\n  }\n}\n</script>\n\n<template>\n  <div ref=\"target\" class=\"relative w-full max-w-md\">\n    <div class=\"flex h-auto items-center bg-secondary border border-primary/10 rounded-sm\">\n      <Button\n        type=\"button\"\n        class=\"flex items-center gap-2 px-4 py-3 rounded-none border-primary/10 hover:bg-primary/5 text-primary-foreground\"\n        variant=\"ghost\"\n        @click=\"open = !open\"\n      >\n        <img\n          v-if=\"!specialCountryCodes.includes(selectedCountry.flag)\"\n          class=\"aspect-square w-6\"\n          :src=\"`https://flagsapi.com/${selectedCountry.flag}/flat/64.png`\"\n        >\n        <div v-else class=\"w-6 h-4 bg-white\" />\n        <span>{{ selectedCountry.code }}</span>\n        <svg class=\"w-3 h-3 text-secondary-foreground/50\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n          <path fill-rule=\"evenodd\" d=\"M5.23 7.21a.75.75 0 011.06.02L10 11.17l3.71-3.94a.75.75 0 111.08 1.04l-4.25 4.5a.75.75 0 01-1.08 0l-4.25-4.5a.75.75 0 01.02-1.06z\" />\n        </svg>\n      </Button>\n\n      <Input\n        type=\"tel\"\n        inputmode=\"numeric\"\n        :placeholder\n        :value=\"phone\"\n        class=\"flex-1 bg-transparent px-4 py-3 rounded-r-sm border-none text-secondary-foreground outline-none ring-none placeholder:text-secondary-foreground/40\"\n        required\n        @update:model-value=\"onInput\"\n      />\n    </div>\n\n    <div\n      v-if=\"open\"\n      class=\"absolute z-50 mt-2 w-full bg-secondary border border-secondary-foreground/10 rounded-sm shadow-xl backdrop-blur-xl\"\n    >\n      <div class=\"p-2\">\n        <Input\n          v-model=\"search\"\n          placeholder=\"Buscar país\"\n          class=\"w-full px-3 py-2 bg-secondary-foreground/5 rounded-sm text-primary-foreground outline-none placeholder:text-secondary-foreground/60\"\n        />\n      </div>\n\n      <div class=\"max-h-64 overflow-y-auto\" role=\"listbox\">\n        <Button\n          v-for=\"c in filteredCountries\"\n          :key=\"c.id\"\n          role=\"option\"\n          variant=\"ghost\"\n          class=\"w-full flex items-center gap-3 px-4 py-2 text-sm text-secondary-foreground/70 hover:bg-secondary/80 transition\"\n          @click=\"selectCountry(c)\"\n        >\n          <img\n            v-if=\"!specialCountryCodes.includes(c.flag)\"\n            :src=\"`https://flagsapi.com/${c.flag}/flat/64.png`\"\n            class=\"aspect-square w-6\"\n          >\n          <div v-else class=\"w-6 h-4 bg-white\" />\n          <span class=\"flex-1 text-left\">{{ c.name }}</span>\n          <span class=\"text-white/40\">{{ c.code }}</span>\n        </Button>\n      </div>\n    </div>\n  </div>\n</template>\n",
      "type": "registry:ui"
    }
  ]
}