{
  "$schema": "https://shadcn-vue.com/schema/registry-item.json",
  "name": "file-input",
  "type": "registry:component",
  "title": "File Input",
  "author": "Danilo Le√≥n <dlg9806@gmail.com>",
  "description": "Componente para subir archivos",
  "registryDependencies": [
    "button"
  ],
  "files": [
    {
      "path": "app/registry/file-input/FileInput.vue",
      "content": "<script setup lang=\"ts\">\nimport type { AcceptType, FilePreview } from './file-input'\nimport { Plus, Trash, Upload, X } from 'lucide-vue-next'\nimport Button from '@/components/ui/button/Button.vue'\nimport { useFileInput } from './useFileInput'\n\nconst { multiple = true, accept = [], maxSize } = defineProps<{\n  multiple?: boolean\n  accept?: AcceptType[]\n  maxSize?: number\n}>()\nconst files = defineModel<FilePreview[]>({\n  default: () => [],\n})\n\nconst { buildAccept, clean, dragging, getFileKind, inputRef, onDrag, onDrop, onInput, onLeave, openPicker, removeFile, totalSize } = useFileInput(files, maxSize)\n</script>\n\n<template>\n  <div\n    class=\"w-full bg-background rounded border p-4 min-h-80 relative overflow-hidden\"\n    @drop.prevent=\"onDrop\"\n    @dragover.prevent=\"onDrag\"\n    @dragleave=\"onLeave\"\n  >\n    <input\n      ref=\"inputRef\"\n      type=\"file\"\n      :multiple\n      :accept=\"buildAccept(accept)\"\n      class=\"hidden\"\n      @change=\"onInput\"\n    >\n\n    <div\n      class=\"absolute inset-0 z-30 flex flex-col items-center justify-center gap-2 transition\"\n      :class=\"[\n        dragging && 'bg-accent/10 border-accent',\n        files.length && 'pointer-events-none opacity-5',\n      ]\"\n      :style=\"{\n        background: 'oklch(from var(--background) l c h)',\n        backgroundImage: `\n    linear-gradient(\n      to right,\n      var(--border) 1px,\n      transparent 1px\n    ),\n    linear-gradient(\n      to bottom,\n      var(--border) 1px,\n      transparent 1px\n    ),\n    radial-gradient(\n      circle at 50% 60%,\n      oklch(from var(--accent) l c h / 0.25),\n      oklch(from var(--muted) l c h / 0.15) 40%,\n      transparent 70%\n    )\n  `,\n        backgroundSize: '40px 40px, 40px 40px, 100% 100%',\n      }\"\n      @click=\"openPicker\"\n    >\n      <span>Subir archivos</span>\n      <span class=\"text-sm\">Arrastre o haga click</span>\n\n      <div class=\"size-32 relative group shadow hover:shadow-none rounded-sm\">\n        <div class=\"absolute inset-0 border-2 border-dashed border-border rounded-sm\" />\n        <div\n          class=\"absolute inset-0 bg-accent flex items-center justify-center rounded-sm\n          group-hover:bg-accent/80 group-hover:translate-x-4 group-hover:-translate-y-2 transition\"\n        >\n          <Upload />\n        </div>\n      </div>\n    </div>\n\n    <div class=\"relative z-20 grid grid-cols-2 md:grid-cols-4 gap-4\">\n      <div\n        v-for=\"(f, i) in files\"\n        :key=\"i\"\n        class=\"relative border rounded overflow-hidden group bg-muted\"\n        :class=\"[f.error && 'border-destructive']\"\n      >\n        <img\n          v-if=\"f.isImage\"\n          :src=\"f.url\"\n          class=\"object-cover w-full h-32\"\n        >\n\n        <div\n          v-else\n          class=\"h-32 flex items-center justify-center text-xs text-muted-foreground\"\n        >\n          <div\n            class=\"flex flex-col items-center justify-center gap-1\"\n            :class=\"getFileKind(f.file)?.color\"\n          >\n            <span class=\"text-2xl\">{{ getFileKind(f.file)?.icon }}</span>\n            <span class=\"text-xs\">{{ getFileKind(f.file)?.label }}</span>\n          </div>\n        </div>\n\n        <span\n          v-if=\"f.error\"\n          class=\"text-xs text-destructive ml-2\"\n        >\n          {{ f.error }}\n        </span>\n\n        <div class=\"px-2 py-1 flex flex-col items-start justify-center gap-1 w-full\">\n          <span\n            class=\"font-medium text-xs truncate w-full\"\n            :title=\"f.file.name\"\n          >\n            {{ f.file.name }}\n          </span>\n          <span\n            class=\"text-muted-foreground text-xs truncate w-full\"\n          >\n            {{ (f.file.size / 1024).toFixed(1) }} KB\n          </span>\n        </div>\n\n        <Button\n          class=\"absolute top-1 right-1 bg-background/60 p-0 rounded-full opacity-0 group-hover:opacity-100 transition\"\n          size=\"icon-sm\"\n          variant=\"secondary\"\n          @click=\"removeFile(i)\"\n        >\n          <X class=\"size-4\" />\n        </Button>\n      </div>\n    </div>\n\n    <div v-if=\"files.length\" class=\"relative z-20 mt-4 text-sm text-muted-foreground\">\n      {{ files.length }} {{ files.length === 1 ? 'archivo' : 'archivos' }} ‚Äî {{ (totalSize / 1024).toFixed(1) }} KB\n    </div>\n\n    <div class=\"w-auto flex items-center justify-center gap-2 absolute bottom-4 right-4 z-30\">\n      <Button\n        v-if=\"files.length > 0\"\n        size=\"icon-sm\"\n        class=\"text-destructive hover:bg-destructive/20\"\n        variant=\"secondary\"\n        @click=\"clean\"\n      >\n        <Trash />\n      </Button>\n      <Button\n        v-if=\"multiple && files.length\"\n        size=\"icon-sm\"\n        class=\"hover:bg-accent/90\"\n        variant=\"secondary\"\n        @click=\"openPicker\"\n      >\n        <Plus />\n      </Button>\n    </div>\n  </div>\n</template>\n",
      "type": "registry:ui"
    },
    {
      "path": "app/registry/file-input/file-input.d.ts",
      "content": "export interface FilePreview {\n  file: File\n  url?: string\n  isImage: boolean\n  error?: string\n}\n\nexport interface FileKind {\n  label: string\n  icon: string\n  color: string\n}\n\nexport type AcceptGroup\n  = | 'image/*'\n    | 'video/*'\n    | 'audio/*'\n    | 'text/*'\n\nexport type AcceptMime\n  = | 'image/png'\n    | 'image/jpeg'\n    | 'image/webp'\n    | 'image/gif'\n    | 'image/svg+xml'\n    | 'video/mp4'\n    | 'video/webm'\n    | 'audio/mpeg'\n    | 'audio/wav'\n    | 'audio/ogg'\n    | 'application/pdf'\n    | 'application/zip'\n    | 'application/json'\n    | 'text/plain'\n    | 'text/csv'\n    | 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'\n    | 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n\nexport type AcceptExtension\n  = | '.png'\n    | '.jpg'\n    | '.jpeg'\n    | '.webp'\n    | '.gif'\n    | '.svg'\n    | '.mp4'\n    | '.webm'\n    | '.mp3'\n    | '.wav'\n    | '.ogg'\n    | '.pdf'\n    | '.zip'\n    | '.json'\n    | '.csv'\n    | '.txt'\n    | '.docx'\n    | '.xlsx'\n\nexport type AcceptType\n  = | AcceptGroup\n    | AcceptMime\n    | AcceptExtension\n",
      "type": "registry:hook"
    },
    {
      "path": "app/registry/file-input/useFileInput.ts",
      "content": "import type { ModelRef } from 'vue'\nimport type { AcceptType, FileKind, FilePreview } from './file-input'\n\nexport const fileTypeMap: Record<string, FileKind> = {\n  'image': {\n    label: 'Imagen',\n    icon: 'üñºÔ∏è',\n    color: 'text-chart-2',\n  },\n  'video': {\n    label: 'Video',\n    icon: 'üé•',\n    color: 'text-chart-3',\n  },\n  'audio': {\n    label: 'Audio',\n    icon: 'üéß',\n    color: 'text-chart-4',\n  },\n  'application/pdf': {\n    label: 'PDF',\n    icon: 'üìÑ',\n    color: 'text-destructive',\n  },\n  'application/zip': {\n    label: 'ZIP',\n    icon: 'üóúÔ∏è',\n    color: 'text-chart-5',\n  },\n  'text': {\n    label: 'Texto',\n    icon: 'üìÉ',\n    color: 'text-muted-foreground',\n  },\n  'default': {\n    label: 'Archivo',\n    icon: 'üì¶',\n    color: 'text-muted-foreground',\n  },\n}\n\nexport function useFileInput(files: ModelRef<FilePreview[], string, FilePreview[], FilePreview[]>, maxSize?: number) {\n  const inputRef = ref<HTMLInputElement | null>(null)\n  const dragging = ref(false)\n\n  function buildAccept(types: AcceptType[]) {\n    return Array.from(new Set(types)).join(',')\n  }\n\n  function openPicker() {\n    inputRef.value?.click()\n  }\n\n  function getFileKind(file: File) {\n    if (fileTypeMap[file.type])\n      return fileTypeMap[file.type]\n\n    const group = file.type.split('/')[0]\n    if (group && fileTypeMap[group])\n      return fileTypeMap[group]\n\n    return fileTypeMap.default\n  }\n\n  function validateFile(file: File): string | undefined {\n    if (maxSize && (file.size > maxSize))\n      return 'El archivo supera 10MB'\n  }\n\n  function clean() {\n    files.value = []\n  }\n\n  function handleFiles(fileList: FileList) {\n    Array.from(fileList).forEach((file) => {\n      const isImage = file.type.startsWith('image/')\n      const url = isImage ? URL.createObjectURL(file) : undefined\n      const error = validateFile(file)\n      files.value?.push({ file, url, isImage, error })\n    })\n  }\n\n  function onInput(e: Event) {\n    const target = e.target as HTMLInputElement\n    if (target.files)\n      handleFiles(target.files)\n  }\n\n  function removeFile(index: number) {\n    const f = files.value[index]\n    if (f?.url)\n      URL.revokeObjectURL(f.url)\n    files.value.splice(index, 1)\n  }\n\n  function onDrop(e: DragEvent) {\n    e.preventDefault()\n    dragging.value = false\n    if (e.dataTransfer?.files)\n      handleFiles(e.dataTransfer.files)\n  }\n\n  function onDrag(e: DragEvent) {\n    e.preventDefault()\n    dragging.value = true\n  }\n\n  function onLeave() {\n    dragging.value = false\n  }\n\n  const totalSize = computed(() =>\n    files.value.reduce((acc, f) => acc + f.file.size, 0),\n  )\n\n  return {\n    inputRef,\n    dragging,\n    openPicker,\n    getFileKind,\n    validateFile,\n    clean,\n    handleFiles,\n    onInput,\n    removeFile,\n    onDrop,\n    onDrag,\n    onLeave,\n    buildAccept,\n    totalSize,\n  }\n}\n",
      "type": "registry:hook"
    }
  ]
}